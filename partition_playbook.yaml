---
- name: "Gestion des partitions et volumes logiques"
  hosts:
    - projet
  become: yes
  gather_facts: no
  ignore_errors: yes

  tasks:
    - name: "Create 1 partition of 100Mo"
      parted: 
        device: /dev/sdb
        number: 3
        state: present
        part_end: 100MiB
        

    - name: "Create 2nd partiton of 100Mo"
      parted:
        device: /dev/sdb
        number: 4
        state: present
        part_end: 200MiB
        part_start: 100MiB
        align: optimal

    - name: "Create volum group"
      lvg:
        vg: vgroup2
        pvs: /dev/sdb3,/dev/sdb4
        pesize: "8"

    - name: "create logical volume"
      lvol:
        vg: vgroup2
        lv: vlogik2
        size: 120M

    - name: "Formatage du volume logique"
      filesystem:
        fstype: ext4
        force: yes
        dev: /dev/vgroup2/vlogik2

    - name: "create point de montage"
      file:
        path: /mnt/logik2/
        state: directory
        mode: 0777

    - name: "montage du volume logique"
      mount:
        path: /mnt/logik2/
        src: /dev/vgroup2/vlogik2
        fstype: ext4
        state: present





